#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 503
\begin_document
\begin_header
\origin unavailable
\textclass article
\begin_preamble
\usepackage{lscape}
\usepackage{afterpage}
\usepackage{geometry}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
D2.3 Report on advanced instrumentation strategy and test matrix selection
 for turbines test case(s) provided by Avio Polska
\end_layout

\begin_layout Author
Michał Dzikowski, Łukasz Łaniewski-Wołłk, Wojciech Gryglas
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Ability to design instrumentation of any type of experiment is crucial to
 cost, effectiveness and robustness of the experimental setup.
 Growing computational power allows to predict phenomenon that is being
 measured.
 Obtained information can be used to perform optimization and design the
 best possible experiment.
 Formal procedure, that will 
\shape italic
a priori
\shape default
 provide instrumentation guidelines, like where to measure pressure on an
 airfoil was the main subject of this work.
 This type of problems refers to so-called optimal experimental design(OED).
 Classical approach to control quality of experimental results are based
 on statistical criteria and have been treated widely in literature 
\begin_inset CommandInset citation
LatexCommand cite
key "ucinski_optimal_2004,pukelsheim_optimal_1993,fedorov_model-oriented_1997,_optimum_1992"

\end_inset

.
 Optimization of measurement locations leads to covariance minimization
 as described for example in Chapter 2.3 of 
\begin_inset CommandInset citation
LatexCommand cite
key "ucinski_optimal_2004"

\end_inset

.
 This approach was adopted in the following work.
 A-criterion was chosen as objective function for optimization purpouse.
 Additionally proper orthogonal decomposition(POD) was used as surrogate
 model.
 The model was required to construct covariance matrix and reconstruct final
 results.
 POD method in this case improves numerical stability of the proposed scheme
 and allows to construct efficient and generic algorithm.
 Presented approach was validated using virtual experiment.
 The experiment consisted of results from numerical simulation based on
 high and low density meshes.
 High density mesh stands for 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

 experimental data, and coarse mesh is being used for POD and thereby for
 measurement locations optimization.
 The goal was to reconstruct pressure profile in the best possible way from
 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

 data applied to the sensors positions.
 The results obtained from optimal positions ware than compared with a profile
 reconstructed from equally distributed points along the profile.
 
\end_layout

\begin_layout Standard
To illustrate basic idea behind optimal instrumentation simple example will
 be presented before detailed description of proposed methodology.
 Assume that some physical quantity 
\begin_inset Formula $y$
\end_inset

 could be measured and described by following linear model
\begin_inset Formula 
\[
y=a_{0}+a_{1}x
\]

\end_inset

The aim of measurement is to estimate 
\begin_inset Formula $a_{0},a_{1}$
\end_inset

 by using two sensors.
 Those two sensors can be located only on the interval 
\begin_inset Formula $[-1,1]$
\end_inset

.
 The question which arises is how to choose optimal locations for these
 sensors so that the result will be the most accurate.
 Due to fact that measurement will be affected by some random error result
 of the observation can be described as
\begin_inset Formula 
\[
Y\approx X\cdot A
\]

\end_inset

where 
\begin_inset Formula 
\[
Y=\left[\begin{array}{c}
y1\\
y2
\end{array}\right],\,X=\left[\begin{array}{cc}
1 & x_{1}\\
1 & x_{2}
\end{array}\right],\,A=\left[\begin{array}{c}
a_{0}\\
a_{1}
\end{array}\right]
\]

\end_inset

To select sensor locations optimally the influence of random errors on estimated
 parameters 
\begin_inset Formula $a_{0},a_{1}$
\end_inset

 should be the smallest possible.
 Therefore some objective function is required which will allow to perform
 optimization in terms of estimated parameters uncertainty.
 Suitable criterion for this purpose is one of statistical criteria, e.g.
 A-optimality or D-optimality.
 Statistical criteria aims to minimize variance of estimator, which in case
 of several model parameters takes matrix form.
 The A-optimality criterion is formulated as seeking for minimal trace of
 information matrix inverse (the mean axis length of the uncertainty ellipsoid
 is minimized, see 
\begin_inset CommandInset citation
LatexCommand cite
key "ucinski_optimal_2004,_optimum_1992"

\end_inset

).
 In the presented example information matrix can be obtained directly from
 assumed linear model
\begin_inset Formula 
\[
M=X^{T}\cdot X
\]

\end_inset

After substituting data from the example the trace of matrix inverse is
 equal 
\begin_inset Formula 
\[
tr(M^{-1})=\frac{x_{1}^{2}+x_{2}^{2}+2}{(x_{1}-x_{2})^{2}}
\]

\end_inset

and its minimal value corresponds to 
\begin_inset Formula $x_{1}=-1$
\end_inset

 and 
\begin_inset Formula $x_{2}=1$
\end_inset

.
 As the result optimal sensor positions for this case is the beginning and
 the end of specified range.
 Assuming that measurement error have constant variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

 and is not correlated then the variance of estimator 
\begin_inset Formula $\hat{a_{1}}$
\end_inset

 can be easy computed for this case
\begin_inset Formula 
\[
Var(\hat{a_{1})}=\frac{1}{\Delta x^{2}}[Var(y_{2})+Var(y_{1})]=\frac{2}{\Delta x^{2}}\sigma^{2}
\]

\end_inset

It is clear that variance of estimator is minimal when distance between
 sensors is the biggest one what confirms the result derived from A-optimality
 criterion.
 For this simple example the result is very intuitive, because line slop
 is less affected by small changes of value in constructing points are spread
 far away from each other.
 
\end_layout

\begin_layout Standard
In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Methodology"

\end_inset

 will be presented description of method and final algorithm used to perform
 validation of proposed approach.
 In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Test-cases-and"

\end_inset

 will be presented validation of instrumentation strategy using virtual
 experiments.
 In the first case validation was performed on NACA 2012 airfoil and in
 the second with 2D WUT cascade.
 
\end_layout

\begin_layout Section
Methodology
\begin_inset CommandInset label
LatexCommand label
name "sec:Methodology"

\end_inset


\end_layout

\begin_layout Subsection
Covariance-minimizing instrumentation strategy
\end_layout

\begin_layout Standard
The main idea behind presented instrumentation strategy, as it was said
 before, is based on A-criterion.
 Assuming, that observed phenomenon is described by linear model 
\begin_inset Formula 
\[
V=W\beta+\mu
\]

\end_inset

where 
\begin_inset Formula $V$
\end_inset

 contains exact data, without error.
 The 
\begin_inset Formula $W$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 are matrix containing base solutions in rows (for example modes) and respective
 weights vector.
 The coefficients 
\begin_inset Formula $\mu$
\end_inset

 are error between linear model 
\begin_inset Formula $W\beta$
\end_inset

 and exact values.
 On the other hand, data measured in experiments is affected by random error
 
\begin_inset Formula $\epsilon$
\end_inset

.
 Therefore it could be expressed as 
\begin_inset Formula 
\begin{equation}
Y=W_{:,m}\beta+\mu+\epsilon\label{eq:rekonstrukcja}
\end{equation}

\end_inset

 where subscript 
\begin_inset Formula $m$
\end_inset

 represents chosen part of 
\begin_inset Formula $W$
\end_inset

 (rewriting matrix 
\begin_inset Formula $W$
\end_inset

 in index notation as 
\begin_inset Formula $W_{ij}$
\end_inset

, 
\begin_inset Formula $W_{:,m}$
\end_inset

 represents chosen rows 
\begin_inset Formula $W$
\end_inset

, in index notation 
\begin_inset Formula $W_{im}$
\end_inset

).
 The random error 
\begin_inset Formula $\epsilon$
\end_inset

 has zero expected value and covariance equal to 
\begin_inset Formula $\gamma\Sigma$
\end_inset

, where gamma is a scalar.
 It is known that, that least square estimator may only be constructed for
 uncorrelated error.
 Using fact, that 
\begin_inset Formula 
\[
\mathrm{Cov}\left(\Sigma^{-1/2}\epsilon\right)=\mathbb{I}
\]

\end_inset

one could rewrite 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rekonstrukcja"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\Sigma^{-1/2}Y=\left(\Sigma^{-1/2}W_{:,m}\right)\beta+\Sigma^{-1/2}\mu+\Sigma^{-1/2}\epsilon\label{eq:rekonstrukcja-1}
\end{equation}

\end_inset

and construct least square for this modified system, where errors are uncorrelat
ed
\begin_inset Formula 
\[
\hat{\beta}=\left[\left(\Sigma^{-1/2}\right)^{T}W_{:,m}^{T}\Sigma^{-1/2}W_{:,m}\right]^{-1}\left(\Sigma^{-1/2}\right)^{T}W_{:,m}^{T}\Sigma^{-1/2}Y
\]

\end_inset

which after simplification gives
\begin_inset Formula 
\begin{equation}
\hat{\beta}=\left[W_{:,m}^{T}\Sigma^{-1}W_{:,m}\right]^{-1}W_{:,m}^{T}\Sigma^{-1}Y\label{eq:lsq-1}
\end{equation}

\end_inset

For uncorrelated error 
\begin_inset Formula $\mathrm{Cov}\left(\epsilon\right)=\gamma\Sigma=\gamma\mathbb{I}$
\end_inset

.
 Most important properties of estimator 
\begin_inset Formula $\hat{\beta}$
\end_inset

 is that 
\begin_inset Formula 
\[
\mathbb{E}\hat{\beta}=\beta
\]

\end_inset

and
\begin_inset Formula 
\[
\mathrm{Cov}\hat{\beta}=\mathbb{E}\left(\hat{\beta}-\beta\right)^{T}\left(\hat{\beta}-\beta\right)=\left(W_{:,m}\Sigma^{-1}W_{:,m}^{T}\right)^{-1}
\]

\end_inset

The A-criterion in this case is formulated as choosing 
\begin_inset Formula $W_{:,m}$
\end_inset

 from 
\begin_inset Formula $W$
\end_inset

 so trace of covariance matrix 
\begin_inset Formula $(W_{:,m}\Sigma^{-1}W_{:,m}^{T})^{-1}$
\end_inset

 is minimal.
 
\end_layout

\begin_layout Subsection
Reduced order model based on POD
\end_layout

\begin_layout Standard
It is clear that before covariance-minimizing instrumentation strategy can
 be applied some linear model is required.
 To build model of the form 
\begin_inset Formula 
\[
V=W\beta
\]

\end_inset

base matrix 
\begin_inset Formula $W$
\end_inset

 is required.
 In presented work, matrix 
\begin_inset Formula $W$
\end_inset

 is constructed using orthogonal vectors 
\begin_inset Formula $W_{m,:}$
\end_inset

 obtained with standard proper orthogonal decomposition of number of solutions.
 Those base solutions ware obtained by CFD analysis of the same case for
 a set of physical parameters, like angle of attack.
 This base solutions set defines subspace in physical parameters space in
 which all experiment should lie.
\end_layout

\begin_layout Standard
In order to obtain matrix 
\begin_inset Formula $W$
\end_inset

 number of simulations are performed.
 Results of those are collected in vectors 
\begin_inset Formula $V_{i}$
\end_inset

, each one has 
\begin_inset Formula $aN$
\end_inset

 elements, where 
\begin_inset Formula $a$
\end_inset

 is a number of physical variables (in present study, 2D compressible flow
 with Spallart-Almaras turbulence model 
\begin_inset Formula $a=5$
\end_inset

, namely density, energy density, 2 components of momentum and turbulent
 viscosity) and 
\begin_inset Formula $N$
\end_inset

 is number of nodes in numerical solution.
 Then, proper orthogonal decomposition is performed, using “method of snapshots”
, as described in Section 3.2 of 
\begin_inset CommandInset citation
LatexCommand cite
key "holmes_turbulence_2012"

\end_inset

 and implemented in Python package modred [
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

https://pythonhosted.org/modred
\end_layout

\end_inset

].
 After decomposition, in number of modes vectors is equal to number of supplied
 cases, each case could be exactly represented in space provided by modes
 vectors
\begin_inset Formula 
\[
V_{i}=W\beta_{i}
\]

\end_inset

It is worth noting, that due to orthogonality of vectors 
\begin_inset Formula $W_{m,:}$
\end_inset

 the covariance of 
\begin_inset Formula $V_{i}$
\end_inset

 is equal to covariance of 
\begin_inset Formula $\beta_{i}$
\end_inset

.
 This property holds true even if not all vectors were taken to construct
 matrix 
\begin_inset Formula $W$
\end_inset

, but only those, that are most significant.
 This is common practice, which reduces size of the model, but preserves
 main physical futures.
 
\end_layout

\begin_layout Standard
Basic work flow of the whole instrumentation optimization procedure was
 presented in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:optim"

\end_inset

.
 Detail of the POD algorithm are skipped in this report, because is is considere
d as fairly standard numerical tool, present in number of code libraries.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../doc/optim.png
	lyxscale 25
	width 75text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Sketch of the instrumentation strategy optimization algorithm work flow.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:optim"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
High performance A-optimum optimizer algorithm
\end_layout

\begin_layout Standard
The A-criterion requires, that trace of information matrix inverse in minimal.
 As the obtained modes or base solutions are highly nonlinear.
 It was found, that interpolation of mode value between original grid point
 introduces oscillations into procedure.
 Therefore gradient based methods are not well suitable to the task with
 concludes in optimal choice of 
\begin_inset Formula $p$
\end_inset

 point from the set of 
\begin_inset Formula $P$
\end_inset

 available mesh point, for example all mesh point on a turbine blade.
 The procedure given in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "procedure"

\end_inset

 was found suitable for that task.
\begin_inset Float algorithm
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Optimizer procedure
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "procedure"

\end_inset


\end_layout

\begin_layout Enumerate
Choose 
\begin_inset Formula $p$
\end_inset

 points out of 
\begin_inset Formula $P$
\end_inset

 available locations, distributed as evenly as possible.
 
\end_layout

\begin_layout Enumerate
Compute A-criterion for all possible position of single point, considering
 all other points as fixed.
\end_layout

\begin_layout Enumerate
If optimal position is not occupied, set a new position for analyzed point.
\end_layout

\begin_layout Enumerate
Take next point into consideration and repeat procedure.
\end_layout

\begin_layout Enumerate
Repeat steps from 2 to 4, until there is no gain in any possible movement
 of any point (each one lies in optimal position, with respect to others
 position).
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It could be seen, that during optimization process, A-criterion needs to
 be evaluated number of times.
 Therefore it is important to derive optimal procedure for that process.
 
\end_layout

\begin_layout Standard
Good performance could be achieved, if the evaluation of A-criterion for
 all possible point positions is consider as evaluation of the A-criterion
 of a matrix, that have one additional row.
 Base matrix represents stationary points, added row is different for all
 tested positions.
 A-criterion is written as trace of inverse of matrix 
\begin_inset Formula $M$
\end_inset

 equal to 
\begin_inset Formula 
\[
M=X\Sigma^{-1}X^{T}
\]

\end_inset

If the matrix 
\begin_inset Formula $X$
\end_inset

 will be extended to 
\begin_inset Formula $[X\,x]$
\end_inset

, the the corresponding information matrix will be equal to 
\begin_inset Formula 
\begin{equation}
\hat{M}=[X\,x]\hat{\Sigma}^{-1}[X\,x]^{T}\label{eq:m_hat}
\end{equation}

\end_inset

The matrix 
\begin_inset Formula $\Sigma$
\end_inset

 also needs to be extended to 
\begin_inset Formula $\hat{\Sigma}$
\end_inset

 equal to 
\begin_inset Formula 
\[
\hat{\Sigma}=\left[\begin{array}{cc}
\Sigma & b\\
b^{T} & \sigma
\end{array}\right]
\]

\end_inset

To obtain trace of 
\begin_inset Formula $\hat{M}^{-1}$
\end_inset

, first the inverse of 
\begin_inset Formula $\hat{\Sigma}$
\end_inset

 is needed.
 After some algebra, it could be found, that 
\begin_inset Formula 
\begin{equation}
\hat{\Sigma}^{-1}=\left[\begin{array}{cc}
\Sigma & b\\
b^{T} & \sigma
\end{array}\right]^{-1}=\left[\begin{array}{cc}
\Sigma^{-1} & 0\\
0 & 0
\end{array}\right]+\frac{1}{\sigma-b^{T}\gamma}\left[\begin{array}{cc}
\gamma\gamma^{T} & -\gamma\\
-\gamma^{T} & 1
\end{array}\right]\label{eq:sigma_hat_-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma=\Sigma^{-1}b$
\end_inset

.
 Substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sigma_hat_-1"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:m_hat"

\end_inset


\begin_inset Formula 
\[
\hat{M}=[X\,x]\hat{\Sigma}^{-1}[X\,x]^{T}=X\Sigma^{-1}X^{T}+\frac{\left(X\gamma-x\right)\left(X\gamma-x\right)^{T}}{\sigma-b^{T}\gamma}
\]

\end_inset

if 
\begin_inset Formula $v=X\gamma-x$
\end_inset

 and 
\begin_inset Formula $\theta=\frac{1}{\sigma-b^{T}\gamma}$
\end_inset

 then
\begin_inset Formula 
\[
\hat{M}=[X\,x]\hat{\Sigma}^{-1}[X\,x]=X\Sigma^{-1}X^{T}+\theta vv^{T}
\]

\end_inset

Assuming, that 
\begin_inset Formula $Ma=\hat{M}\hat{a}=b$
\end_inset

 it could be found that 
\begin_inset Formula 
\[
v^{T}\hat{a}=\frac{v^{T}}{1+\theta v^{T}M^{-1}v}a
\]

\end_inset

Letting 
\begin_inset Formula $w=M^{-1}v$
\end_inset

, after some algebra, it could be derived, that 
\begin_inset Formula 
\[
\hat{M}^{-1}=M^{-1}-\frac{\theta}{1+\theta v^{T}w}ww^{T}
\]

\end_inset

therefore A-criterion of 
\begin_inset Formula $\hat{M}$
\end_inset

 is equal to
\begin_inset Formula 
\[
tr\hat{(M}^{-1})=tr(M^{-1})-\frac{\theta}{1+\theta v^{T}w}w^{T}w
\]

\end_inset


\end_layout

\begin_layout Standard
It should be underlined here, that 
\begin_inset Formula $tr(M^{-1})$
\end_inset

 could be computed once, per whole swept on single point.
 Furthermore, for simple, uncorrelated case, where 
\begin_inset Formula $\Sigma=\mathbb{I}$
\end_inset

, the right term of above equation is equal to 
\begin_inset Formula $\frac{w^{t}w}{1+x^{T}w}$
\end_inset

 where 
\begin_inset Formula $w=M^{-1}x$
\end_inset

.
 The matrix 
\begin_inset Formula $M$
\end_inset

 still needs to be inverted, but only once per swept, which drastically
 reduced computational power needed, especially for larger cases.
 This procedure is applicable for large 2D or 3D cases, as long as it is
 possible to inverse matrix 
\begin_inset Formula $M$
\end_inset

, and to obtain enough POD modes to properly describe the problem.
 It should be emphasized, that matrix 
\begin_inset Formula $M$
\end_inset

 is of order of the number of instrumentation points, not the CFD mesh.
 This means, that for even large industrial experiment inverse of matrix
 
\begin_inset Formula $M$
\end_inset

 shouldn't be a problem.
 The term 
\begin_inset Formula $trM^{-1}$
\end_inset

 could, and should, be means of eigenvalue decomposition, which is also
 numerically more stable.
 Furthermore, the terms involving 
\begin_inset Formula $w$
\end_inset

 could rewritten, to 
\begin_inset Formula 
\[
M^{-1}x=V\lambda^{-1}V^{T}x
\]

\end_inset

where
\begin_inset Formula 
\[
M=V\lambda V^{T}
\]

\end_inset

which will ensure numerical stability of the scheme.
\end_layout

\begin_layout Section
Test cases and results
\begin_inset CommandInset label
LatexCommand label
name "sec:Test-cases-and"

\end_inset


\end_layout

\begin_layout Subsection
NACA 2012
\end_layout

\begin_layout Standard
To evaluate method performance and robustness, the virtual instrumentation
 NACA 0012 was evaluated.
 The flow around the airfoil was evaluated using in-house CFD code RED for
 number of angles of attack and Mach numbers.
 Each pair of angle of attack and Ma is a point in parameter space.
 Evaluation was carried for 10 Mach numbers from 0.2 to 0.7 and 10 angles
 of attack from 1.2 to 3.2 degrees.
 The, the POD decomposition was performed on obtained data.
 To reduce number of modes in consideration, the maximum difference between
 full solution and the reconstructed one on limited number of modes was
 then calculated.
 Results of those computation are presented in Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-number-of-modes-V0"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-number-of-modes-V1"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-number-of-modes-V2"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-number-of-modes-V3"

\end_inset

.
 It could be seen, that even 10 modes (in this case) should give reasonable
 reconstruction of the flow properties.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/V0.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The number of modes needed for proper reconstruction of majority of the
 flow could be estimated by computing maximum difference between solution
 projected on 
\begin_inset Formula $n$
\end_inset

 modes and the full solution.
 Maximum difference in density field is presented on above figure.
 Each line represent different angle of attack and mach number pair.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-number-of-modes-V0"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/V1.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The number of modes needed for proper reconstruction of majority of the
 flow could be estimated by computing maximum difference between solution
 projected on 
\begin_inset Formula $n$
\end_inset

 modes and the full solution.
 Maximum difference in energy density field is presented on above figure.
 Each line represent different angle of attack and mach number pair.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-number-of-modes-V1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/V2.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The number of modes needed for proper reconstruction of majority of the
 flow could be estimated by computing maximum difference between solution
 projected on 
\begin_inset Formula $n$
\end_inset

 modes and the full solution.
 Maximum difference in X-momentum field is presented on above figure.
 Each line represent different angle of attack and mach number pair.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-number-of-modes-V2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/V3.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The number of modes needed for proper recontruction of majority of the flow
 could be estimated by computing maximum diference between solution projected
 on 
\begin_inset Formula $n$
\end_inset

 modes and the full solution.
 Maximum diference in Y-momentum field is presented on above figure.
 Each line represente diferent angloe of atack and mach number pair.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:The-number-of-modes-V3"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Further analysis of obtained reconstruction consisted in calculation of
 flow properties on high density mesh.
 Both high and low density meshes are presented in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Left:-low-density-mesh"

\end_inset

.
 The high density mesh was obtained by subdividing low density mesh, therefore
 it consists all low-density nodes.
 Then, the obtained results were projected on low density modes.
 The obtained momentum field and high resolution one are presented in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:X-and-Y-reconstruct"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/small_grid1.png
	lyxscale 25
	width 50text%

\end_inset


\begin_inset Graphics
	filename ../naca0012_1/small_grid2.png
	lyxscale 25
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Left: low density grid used to obtain input for POD decomposition.
 Right: high density grid used to validate POD and as virtual experimental
 data.
\begin_inset CommandInset label
LatexCommand label
name "fig:Left:-low-density-mesh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/small_u.png
	lyxscale 25
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../naca0012_1/small_v.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
X and Y momentum field obtained on high density grid (lines) and after projectio
n on POD modes (color field)
\begin_inset CommandInset label
LatexCommand label
name "fig:X-and-Y-reconstruct"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
After those preliminary steps, the optimization process was performed.
 The main goal was set, to obtain proper pressure profile by means of measuring
 pressure only on airfoil surface in minimum possible number of points.
 It was found, that only 10 modes and 21 point are enough to obtain high
 quality reconstruction.
 The optimization process convergence and history is summarized in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Instrumentation-positions-optimi"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/iterations.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Instrumentation positions optimization process.
 Upper picture: convergence of A-criterion, thick black line denotes uniform
 distribution.
 Lower: each line denotes position of the point in all iterations 
\begin_inset CommandInset label
LatexCommand label
name "fig:Instrumentation-positions-optimi"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/points.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Resulting of optimization of instrumentation points distribution.
 Red crosses denotes uniform points distribution (uniform in spline parameter
 space) and green dots denotes optima ones.
 In the design process of real experiment the size of experimental part
 will be known, and minimum distance between points should be take into
 account, as long as possible correlation between measurements.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Instrumentation-positions-optimi-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The evaluation of obtained instrumentation strategy was performed using
 100 randomly disturbed pressure profiles.
 Those ware obtained by adding random variable to pressure profile obtained
 on high density grid, random variable have normal distribution with standard
 derivation equal to 0.05 of maximum pressure difference in whole area (maximum
 minus minimum pressure on the airfoil).
 The influence of this distortions and reconstructed pressure profile are
 summarized in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pMa0.2"

\end_inset

 for the case without shock wave, and in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pMa0.7-1"

\end_inset

 for the case with a shock wave.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways true
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/MA_0.2_alp_2.2_pressure.png
	lyxscale 25
	height 80text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The result of virtual experiment.
 Blue line denotes pressure profile obtained for MA=0.2 and angle of attack
 2.2on high density mesh.
 It is considered as 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

.
 Thins gray lines denotes optimal and uniform instrumentation points positions.
 Color field around reconstructed lines denotes standard deviation of each
 reconstructed solution.
 It should be noted that for most of the figure black dots representing
 reconstructed solution overlaps with blue line representing pressure profile
 to be reconstructed.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:pMa0.2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/MA_0.2_alp_2.2_stdderiv.png
	lyxscale 25
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/MA_0.7_alp_2.2_stdderiv.png
	lyxscale 25
	width 80text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Standard derivation of interpolated and reconstructed solutions.
 Upper picture is for a case without shock wave (Ma=0.2) lower one for the
 case with a shock wave Ma=0.7
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways true
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_naca_multisweapt/MA_0.7_alp_2.2_pressure.png
	lyxscale 25
	height 80text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The result of virtual experiment.
 Blue line denotes pressure profile obtained for MA=0.7 and angle of attack
 2.2on high density mesh.
 It is considered as 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

.
 Thins gray lines denotes optimal and uniform instrumentation points positions.
 Color field around reconstructed lines denotes standard deviation of each
 reconstructed solution.
 It should be noted that for most of the figure black dots representing
 reconstructed solution overlaps with blue line representing pressure profile
 to be reconstructed.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:pMa0.7-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
2D cascade case
\end_layout

\begin_layout Standard
Final evaluation of the presented method was performed using cascade used
 in WUT transonic wind tunnel.
 2D simulations on coarse mesh ware carried for 10 different angles of attack
 from 0 to 25 degrees and for 11 different pressure differences, from 0.4
 to 0.03.
 Those simulations contained not only valid points, near design point of
 the cascade, but also off-design point with separation bubbles and other
 physical and not-physical artifacts.
 Despite of that, reconstruction method provides good agreement with the
 solution obtained on high resolution mesh, treated as experimental data.
 Both coarse and high resolution meshes are presented in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cascade-mesh"

\end_inset


\end_layout

\begin_layout Standard
Obtained results were decomposed, and used as an input to optimization procedure
 for the instrumentation strategy.
 History and convergence of this optimization process are presented in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Instrumentation-positions-optimi-2"

\end_inset

.
 The instrumentation points distribution is presented in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Instrumentation-positions-optimi-1-1"

\end_inset

.
 The measurements points are distributed on the low-pressure part of the
 airfoil and near the leading edge of the airfoil.
 The complete flow field around the cascade obtained with estimated values
 of modes coefficients are presented in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Velocity-magnitude-around"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Density-contours-around"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_cascasde_1/mesh.png
	lyxscale 25
	width 50text%

\end_inset


\begin_inset Graphics
	filename ../optimized_cascasde_1/mesh2.png
	lyxscale 25
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
On the left: high resolution mesh, used to carry out simulations used as
 virtual experiments.
 On the right: coarse mesh used to carry out simulations used as the POD
 input.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:cascade-mesh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_cascasde_1/optimization.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The history of the optimization process.
 In the upper figure the history of the A-criterion together with A-criterion
 of uniformly distributed points are presented.
 In the lower figure positions of the instrumentation points are presented
\begin_inset CommandInset label
LatexCommand label
name "fig:Instrumentation-positions-optimi-2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_cascasde_1/profil.png
	lyxscale 25
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Resulting instrumentation points distribution.
 Red crosses denotes uniform points distribution (uniform in spline parameter
 space) and green dots denotes optima ones.
 In the design process of real experiment the size of experimental part
 will be known, and minimum distance between points should be take into
 account, as long as possible correlation between measurements.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Instrumentation-positions-optimi-1-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways true
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_cascasde_1/Aoa45P0.359_pressur.png
	lyxscale 25
	height 80text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The result of virtual experiment.
 Blue line denotes pressure profile obtained for angle of attack equal to
 0 and pressure on outlet equal to 0.7.
 It is considered as 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

.
 Thin gray lines denotes optimal and uniform instrumentation points positions.
 Color field around reconstructed lines denotes standard deviation of each
 reconstructed solution.
 It should be noted that for most of the figure black dots representing
 reconstructed solution overlaps with blue line representing pressure profile
 to be reconstructed.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:pMa0.7-1-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../optimized_cascasde_1/Aoa45P0.359_stdderiv.png
	lyxscale 25
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Standard deviation of interpolated and reconstructed solutions of the cascade
 element.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_cascasde_1/small_velocity2_rec.png
	lyxscale 25
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_cascasde_1/small_velocity2.png
	lyxscale 25
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Velocity magnitude around cascade element.
 The velocity field reconstructed form pressure measurements on the airfoil
 surface is presented in upper picture.
 The virtual experiment result, computed on much finer mesh, is presented
 in lower figure
\begin_inset CommandInset label
LatexCommand label
name "fig:Velocity-magnitude-around"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_cascasde_1/small_density_rec.png
	lyxscale 25
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../optimized_cascasde_1/small_density.png
	lyxscale 25
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Density contours around cascade element.
 The density field reconstructed form pressure measurements on the airfoil
 surface is presented in upper picture.
 The virtual experiment result, computed on much finer mesh, is presented
 in lower figure
\begin_inset CommandInset label
LatexCommand label
name "fig:Density-contours-around"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Summary
\end_layout

\begin_layout Standard
High performance, robust instrumentation strategy algorithm was developed,
 implemented and tested in two test cases: NACA 0012 airfoil and WUT cascade.
 In both cases the optimization goal was to obtain positions of pressure
 sensors which will give best possible pressure distribution on whole airfoil
 or blade.
 Optimization precess consisted in two main steps: number of CFD analysis
 on coarse grid were carried out.
 Then, the proper orthogonal decomposition of obtained data was made to
 construct linear model with unknown parameters.
 The last part was to find the optimal points distribution to estimate those
 unknown parameter of linear model by means of least-square fit.
 To validate he optimal points distribution, simulation on much finer grid
 was performed, results from this simulation are treated as the experiment
 to be measured.
 The random error influence on the experiment result was simulated using
 random variable with normal distribution added to the commuted pressure
 field.
 Obtained pressure field was the probed in design points, and used to obtain
 flow field using linear model.
 It was found that this method not only reduces standard deviation of estimated
 pressure profile, but is also able to prevent artifacts from coarse grid
 from contaminating reconstructed solution.
 This is due to cut-off of the POD modes after certain number.
 It was observed in the results, that introducing additional modes into
 considered set should be considered as over-fitting.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintAll"
bibfiles "top"
options "plain"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Section
D2.9 Report on the performance of the proposed instrumentation strategy verified
 by experiments performed by WUT (month 30)
\end_layout

\begin_layout Section
MS2.6 Advanced instrumentation methodology
\end_layout

\begin_layout Section
Task 2.4 Cold Flow Pre-Test support
\end_layout

\begin_layout Plain Layout
Development of advanced instrumentation strategy applied to multistage turbine,
 based on the DoE and Uncertainty Management approaches.
\end_layout

\begin_layout Plain Layout
Validation of the methodology on the benchmark cases provided by AvioPolska
 and selected experiments performed in the transonic and cascade Wind tunnels
 of WUT.
 This task will use results from task 2.1 to help defining proper instrumentation
 for the experimental hardware, in line with test objectives.
\end_layout

\begin_layout Section
Task 2.1Virtual modeling (basic)
\end_layout

\begin_layout Plain Layout
Validation of the virtual modeling approach using RANS/URANS commercial
 solver for complete detailed investigation of a Low Pressure Turbine module.
 
\end_layout

\end_inset


\end_layout

\end_body
\end_document
